# 会话群

在宜搭内提交表单，即可创建钉钉会话群，并且可对创建的群聊群名、群成员进行更改。
## 实现效果​

创建群会话效果如下图：

更新群会话效果展示

## 步骤一：搭建并配置「创建会话群」表单​

创建表单，用于录入创建会话群所需的群名、群主、群成员数据。
**操作步骤：**新建普通表单，命名为「创建会话群」。添加单行文本组件，命名为「群聊名称」，设置为必填。（操作如图2.1-1 所示）

图2.1-1 添加并配置单行文本组件
添加成员组件，命名为「选择群主」，设置为必填项。（操作如图2.1-2 所示）

图2.1-2 添加并配置成员组件
添加另一个成员组件，命名为「选择群成员」，设置为必填项，并开启多选模式。（操作如图2.1-3 所示）

图2.1-3 添加并配置成员组件
点击页面右上角「保存」按钮即可。
## 步骤二：搭建并配置「会话群数据汇总」表单​

创建表单，用于记录「创建会话群」表单所创建的群聊的信息。包括群名以及群聊 ID，其中群聊 ID 需要从创建会话群的连接器返回的数据中获取。
**操作步骤：**新建普通表单，命名为「会话群数据汇总」。添加两个单行文本组件，分别命名为「���聊名称」及「群聊 ID」。（操作如图2.1-4 所示）

图2.1-4 添加并配置单行文本组件
点击右上角保存按钮即可。
## 步骤三：搭建并配置「更新会话群」表单​

创建表单，用于录入对通过连接器创建成功的群聊更新所需的数据。
**操作步骤：**新建普通表单，命名为「更新会话群」。添加下拉单选组件，命名为「选择群聊」，设为必填项，选项关联自「会话群数据汇总」表单中「群聊名称」组件。（操作如图2.1-5 所示）

图2.1-5 添加并配置下拉单选组件
添加单行文本组件，命名为「群聊 ID」，设置数据联动，关联「会话群数据汇总」表单，当「选择群聊」组件的值等于「群聊名称」组件值时，「群聊 ID」的值等于「群聊 ID」组件的值。（操作如图2.1-6 所示）

图2.1-6 添加单行文本组件并设置数据联动
添加两个成员组件，分别命名为「添加群成员」及「删除群成员」，开启多选模式。（操作如图2.1-7 所示）

图2.1-7 添加并配置成员组件
添加单行文本组件，命名为「更改后群聊名称」。（操作如图2.1-8 所示）

图2.1-8 添加并配置单行文本组件
点击页面右上角「保存」按钮即可。
## 步骤四：给「创建群会话」表单添加并配置连接器​

宜搭连接器介绍，请参见集成&自动化-连接器
通过上述步骤，调用连接器所需的基础表单已经搭建完毕。接下来，「创建会话群」表单及「更新会话群」表单进行连接器的添加与配置，
为实现需求做逻辑层面的准备。
该连接器用于实现提交「创建会话群」表单时，系统自动在钉钉上创建会话群。
**操作步骤：**后台管理页>>「创建会话群」>>「集成&自动化」>>「新建集成&自动化」（操作如图2.2-1 所示）

图2.2-1 连接器配置入口
填写连接器名称为「创建会话群」，触发类型选择「表单事件触发」，点击「确认」按钮。
（操作如图2.2-2 所示）

图2.2-2 新建连接器
配置表单触发事件：触发事件为「创建成功」，数据过滤选择「全部数据」，点击保存。
（操作如图2.2-3 所示）

图2.2-3 配置连接器表单触发事件
选择连接器应用：应用选择为「会话群」，点击「下一步」按钮。（操作如图2.2-4 所示）

图2.2-4 选择连接器应用
选择执行动作：执行动作选择为「创建会话群」，点击「下一步」按钮。（操作如图2.2-5 所示）

图2.2-5 选择连接器执行动作
配置执行动作，点击「保存」按钮。（操作如图2.2-6 所示）

图2.2-6 配置连接器执行动作
点击页面右上角「保存」按钮后，点击「发布」按钮，即可。在「连接器」节点下方添加「新增数据」节点，并进行配置。用于将群会话ID返回到「群会话数据汇总」表单中。（操作如图2.2-7 所示）

图2.2-7(1) 添加新增数据节点

图2.2-7(2) 配置新增数据节点

## 步骤五：给「更新群会话」表单添加并配置连接器​

该连接器用于实现提交「更新会话群」表单时，系统自动在钉钉上更新通过连接器创建的会话群。
**操作步骤：**后台管理页>>「创建会话群」>>「设置」>>「页面设置」>>「集成&自动化」>>「新建集成&自动化」（操作如图2.2-8 所示）

图2.2-8 连接器配置入口
填写连接器名称为「创建会话群」，触发类型选择「表单事件触发」，点击「确认」按钮。
（操作如图2.2-9 所示）

图 2.2-9 新建连接器
配置表单触发事件：触发事件为「创建成功」，数据过滤选择「全部数据」，点击保存。
（操作如图2.2-10 所示）

图2.2-10 配置连接器表单触发事件
选择连接器应用：应用选择为「会话群」，点击「下一步」按钮。
（操作如图2.2-11 所示）

图2.2-11 选择连接器应用
选择执行动作：执行动作选择为「创建会话群」，点击「下一步」按钮。
（操作如图2.2-12 所示）

图2.2-12 选择连接器执行动作
配置执行动作，点击「保存」按钮。（操作如图2.2-13 所示）

图2.2-13 配置连接器执行动作
点击页面右上角「保存」按钮后，点击「发布」按钮，即可。
## 步骤六：提交「创建群会话」表单，触发创建群聊连接器​

图2.3-1 提交创建群会话表单

## 步骤七：提交「更新群会话」表单，触发更新群聊连接器​

图2.3-2 提交更新群会话表单
## 常见问题​

Q：如何获取通过连接器创建的群聊的群ID？
A：可以在创建群聊连接器下发添加一个新增数据节点，并将连接器返回数据中群会话ID持久化到其他表单。（操作如下图）