# 数据目录

**注意：**
本功能仅能查询到「当前日期」之前的数据。
例如：今天是2021年12月1日，该功能仅可查询12月1日以前的数据。
## 1. 使用场景​

通过宜搭内置的「数据目录」连接器，可获取企业即时沟通中群聊的统计数据。包括：**群聊用户数**：指企业内发送群聊消息用户数。**新增群数**：指企业内部群新增数量。**活跃群数**：指有群聊消息发生的企业内部群数量。**群聊消息数**：指企业内部群消息数。**内部群数量**：指当前存在的企业内部群数量。**部门群数量**：指当前存在的部门群数量。
## 2. 操作步骤​

### 2.1 步骤一：表单设计​

创建两个表单，分别用于触发连接器以及接收并展示连接器返回的数据。2.1.1 创建「查询企业群聊统计数据」表单​
**操作步骤：**创建普通表单，命名为「查询企业群聊统计数据」。添加日期组件，命名为「查询日期」，并设置为必填项。（操作如图2.1-1 所示）

图2.1-1 添加并配置日期组件点击页面右上角「保存」按钮，即可。2.1.2 创建「企业群聊数据明细」表单​
**操作步骤：**创建普通表单，命名为「企业群聊数据明细」。添加多行文本组件，命名为「返回数据」，状态设置为「隐藏」。（操作如图2.1-2 所示）

图2.1-2 添加并配置多行文本组件添加子表单组件，命名为「企业群聊统计明细表」，状态设置为「只读」。（操作如图2.1-3 所示）

图2.1-3 添加并配置子表单组件在子表单内添加7个单行文本组件，分别命名为「查询日期、群聊用户数、新增群数、活跃群数、群聊消息数、内部群数量、部门群数量」，状态均设置为「只读」。（操作如图2.1-4 所示）

图2.1-4 添加并配置子表单内的7个单行文本组件在JS面板内添加下述代码，进行数据处理。（操作如图2.1-5 所示）

图2.1-5 添加JS代码进行数据处理
上述代码如下所示：
注意进行组件唯一标识的替换！
export function didMount() {  // 获取连接器返回数据，其中「textareaField_ky16z248」为多行文本组件唯一标识，请注意替换，否则会失效哦！！！  const str = this.$("textareaField_ky16z248").getValue();  //进行数据处理  const obj = JSON.parse(str);  const val = obj.dataList;  let arr = [];  const valList = val.map(item => {    let valObject = {};    //查询日期          //需将 textField_ky16z24k 替换为您创建的组件的唯一标识    valObject.textField_ky16z24k = item["stat_date"];    //用户群聊数          //需将 textField_ky16z24l 替换为您创建的组件的唯一标识    valObject.textField_ky16z24l = item["4030_DAY"];    //新增群数          //需将 textField_ky16z24j 替换为您创建的组件的唯一标识    valObject.textField_ky16z24j = item["4031_DAY"];    //活跃群数          //需将 textField_ky16z24i 替换为您创建的组件的唯一标识    valObject.textField_ky16z24i = item["4032_DAY"];    //群聊信息数          //需将 textField_ky16z24h 替换为您创建的组件的唯一标识    valObject.textField_ky16z24h = item["4033_DAY"];    //内部群数量          //需将 textField_ky16z24g 替换为您创建的组件的唯一标识    valObject.textField_ky16z24g = item["4034_DAY"];    //部门群数量          //需将 textField_ky16z24f 替换为您创建的组件的唯一标识    valObject.textField_ky16z24f = item["4035_DAY"];    arr.push(valObject);  })  //将处理好的数据赋值给子表单组件     //需将 tableField_ky16z24a 替换为您创建的单行文本组件的唯一标识  this.$("tableField_ky16z24a").setValue(arr); }

点击页面右上角「保存」按钮，即可。
### 2.2 步骤二：添加连接器​

连接器详细介绍，请移步：此处为语雀内容卡片，点击链接查看：https://www.yuque.com/yida/support/zevvr1
给「查询企业群聊统计数据」表单添加连接器，用于与钉钉数据目录连接器进行数据集成。
**操作步骤：**后台管理页面>>选中「查询企业群聊统计数据」表单>>选择「集成&自动化」>>点击「新建集成&自动化」按钮。（操作步骤如图2.2-1 所示）

图2.2-1 连接器入口新建名为「查询企业统计数据」的连接器，触发类型选择「表单事件触发」，点击「确定」按钮。
（操作如图2.2-2 所示）

图2.2-2 创建连接器配置表单事件触发：触发事件选择「创建成功」，数据过滤选择「全部数据」，点击「保存」按钮。
（操作如图2.2-3 所示）

图2.2-3 配置连接器表单事件触发选择应用>>「数据目录」>>「下一步」。（操作如图2.2-4 所示）

图2.2-4 选择连接器应用选择执行动作>>「获取企业群聊统计数据」>>「下一步」。（操作如图2.2-5 所示）

图2.2-5 选择连接器执行动作配置执行动作>>查询时间>>「字段」>>「查询日期」>>「保存」。（操作如图2.2-6 所示）

图2.2-6 配置连接器执行动作添加新增数据节点，在「接收企业群聊统计数据」表单中，新增单条数据，将「连接器返回数据」的值设置为「业务返回结果」「字段」。（操作如图2.2-7 所示）

图2.2-8 添加并配置「新增数据」节点点击页面右上角「保存」按钮后，点击「发布」按钮，即可。
### 2.3 步骤三：提交表单数据​

**操作步骤：**
提交「查询企业群聊统计数据」表单，用于触发连接器。连接器的返回结果可以在「企业群聊统计数据明细」表单中进行查看。（操作如图2.3-1 所示）

图2.3-1 提交表单
## 3. 效果展示​

**操作路径：**后台管理页面 >>「企业群聊数据明细」>> 数据管理 >> 查看详情（最终效果如图3.1 所示）

图3.1 连接器最终效果展示