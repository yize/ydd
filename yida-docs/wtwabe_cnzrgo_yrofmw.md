---
title: 报表公式
url: https://docs.aliwork.com/docs/yida_support/wtwabe/cnzrgo/yrofmw
source: docs.aliwork.com
---

# 报表公式

跳到主要内容首页帮助手册用户手册精品模板手册更新日志使用案例表单专题自定义页面专题连接器专题实用工具专题报表专题公式专题方案专题更新日志历史文档场景方案开发者手册搭建技巧使用案例视频中心示例中心开发者中心开发者手册低代码直播开发者论坛校企合作简体中文简体中文English日本語搜索用户手册宜搭简介快速开始表单管理表单介绍表单设计表单基础信息新建表单字段属性常用字段高级字段行业字段（教育）公式函数公式概览报表公式表单公式数据准备公式公式案例表单自定义表单页面设置表单属性数据管理表单案例流程设计集成&自动化门户设计报表设计聚合表设计大屏设计自定义页面酷应用平台管理应用管理AI专区插件中心国际化专属宜搭私有化宜搭联系我们开发者功能（需有代码基础）用户手册表单管理表单设计公式函数报表公式本页总览报表公式 1. 使用场景​有时候，原始表单中的数据，我们需要经过一些自定义的处理之后才能展示。例如：表单中的数据是每个员工填写的，而报表中希望展示每天填写表单的员工人数，这个就需要使用到 COUNT()函数计算之后作为结果来进行展示了用户希望在表单中新增一些自定义的字段，然后通过这些字段关联超链接来做页面跳转，这样的需求也可以使用到这里的自定义公式字段的功能为了实现上述需求，我们需要先来了解一下，目前宜搭平台对于报表都提供了哪些公式，主要分为下面两大类：逻辑判断类字符串处理类聚合类数组类2. 报表公式视频讲解​3. 设置公式入口​路径：新建报表 >> 报表设计页 >> 选择数据集 >> 选择显示列字段 >> FX >> 设置对应公式即可查看以下视频进行设置：4. 逻辑判断类​CASEWHEN​用法1：CASEWHEN(<条件>,<值>,<条件>,<值>.....), 类同SQL中的case when语法示例：CASEWHEN(<性别字段>="男","male",<性别字段>="女","female")，则该字段值为"男"的被替换为"male"，"女"替换为"female"用法2：CASEWHEN(<条件>,<值>,<条件>,<值>.....<值>), 类同SQL中的case when语法示例：CASEWHEN(<性别字段>="男","male","female")，则该字段值为"男"的被替换为"male"，非"男"替换为"female"5. 字符串处理类​LEN​用法：LEN([字符串字段])，函数返回为字符串的长度示例：LEN("test")，返回值为4；LEN("测试")，返回值为2，一个中文对应1个英文字符。LEFT​用法: LEFT(<度量字段>,< n >), 函数返回<字段>值从左边第1个字符开始,长度为n的字符串示例: LEFT(字段1,3) ，字段1的值为"ABCDEF";返回值为"ABC";RIGHT​用法： RIGHT(<度量字段>,< n >), 函数返回<字段>值从右往左数的长度为n的字符串示例：RIGHT(字段1,3) 返回值为"DEF";字段1的值为"ABCDEF";MID​用法：MID(<度量字段>, < start >, < n >), 函数返回<字段>值从从左边第start个开始, 长度为n的字符串示例：MID(字段1, 3, 3) 返回值为"CDE";字段1的值为"ABCDEF";POS​用法：POS(<度量字段>,<字串>), 函数返回<字串>在<文本>中的位置, 如无匹配则返回0;示例：POS(字段1,"DE") 返回值为4;字段1的值为"ABCDEF";UPPER​用法：UPPER(<度量字段>), 将<字段>的值转换成大写;示例：UPPER(字段1) 返回值为"ABCDEF";字段1的值为"AbcdeF";LOWER​用法：LOWER(<度量字段>), 将<字段>的值转换成小写;示例：LOWER(字段1) 返回值为"abcdef";字段1的值为"AbcdeF";VAL​用法：VAL(<度量字段>), 将<字段>文本类型转换成数值类型示例：VAL(字段1) 返回值为 123;字段1的值为"123";LEFTTRIM​用法：LEFTTRIM(<度量字段>), 去掉<字段>左边的空格后返回示例：LEFTTRIM(字段1) 返回值为"ABC";字段1的值为" ABC";RIGHTTRIM​用法：RIGHTTRIM(<度量字段>), 去掉<字段>右边的空格后返回示例：RIGTTRIM(字段1) 返回值为"ABC";字段1的值为"ABC ";NUMBERTOSTRING​用法：NUMBERTOSTRING(<数值>), 数值类型的数据转换成字符串示例：NUMBERTOSTRING(字段1) 返回值为"12345";字段1的值为"12345 ";SPLITPART​用法：SPLITPART(<字符串字段>,分隔字符，子串位置), 公式会将一个字符串按照“分隔字符”将其分为N个子串(N等于分隔字符的数量+1)，子串位置从1（从左往右）开始计数，或者从-1（从右往左）开始计数示例：SPLITPART(<字段1>,A,2) 返回值为"BCD";字段1的值为"ABCDABHABC";子串位置填写-5时，也可以取到"BCD"CONCAT​用法：CONCAT(<字段>,<字段>,.....), 公式会将多个字段连接为一个字符串。入参必须为字符串类型的字段示例：CONCAT(<字段1>,<字段2>) 返回值为"ABCD";字段1的值为"A"，字段2的值为"BCD"REPLACE​用法：REPLACE([字符串], [搜索字符串], [替换字符串]), 函数返回为替换后的字符串示例：REPLACE([字段1], [字段2], [字段3])返回值为"a12345efg";字段1的值为"abcdefg",字段2的值为""bcd",字段3的值为"12345".STRINGTONUMBER​新增本文处理类报表公式 STRINGTONUMBER()，该公式用于将文本类型的数字，转换成数值类型。该公式目前仅支持报表页面使用，使用公式语法如下：// 字段为文本类型的数字。STRINGTONUMBER（<字段＞）字符串处理类函数点击体验效果。6. 聚合类​为了便于演示聚合类字段的使用效果，这里以一个实际的案例来辅助介绍首先，假设我们通过多个表单收集到了如下的两个数据集「示例数据集1」和「示例数据集2」示例数据集1数据集BU部门预算类型费用xxpt协同团建费500xxpt协同培训费200xxptIT团建费700xxptIT培训费150aliyun飞天1团建费200aliyun飞天1培训费100表格BU部门部门总费用xxpt协同700xxptIT850aliyun飞天1300示例数据集2数据集BU部门预算类型费用xxpt协同团建费500xxpt协同培训费200xxpt协同团建费500xxpt协同培训费200xxptIT团建费700xxptIT培训费150xxpteHR培训费0xxpteHR团建费0aliyun飞天1团建费200aliyun飞天1培训费100表格BU部门预算类型xxpt协同团建费xxpt协同培训费xxptIT团建费xxptIT培训费xxpteHR培训费xxpteHR团建费aliyun飞天1团建费aliyun飞天1培训费SUM​用法：SUM (<度量字段>,[条件],[排除字段]) 返回合乎[条件]下, 对<字段>进行求和的结果, [排除字段] 不参与求和的交叉计算;示例：使用示例数据集1部门团建费 =SUM (费用, 预算类型="团建费") :注意：目前报表类聚合函数暂不支持进行逻辑运算。表格结果BU部门部门总费用部门团建费xxpt协同700500xxptIT850700aliyun飞天1300200BU 团建费= SUM (费用, 预算类型="团建费", 部门) :表格结果BU部门部门总费用部门团建费BU团建费xxpt协同7005001200xxptIT8507001200aliyun飞天1300200200AVG​用法：AVG(<度量字段>,[条件],[排除字段])用法介绍：返回合乎[条件]下, 对<字段>进行求平均的结果, [排除字段] 不参与求和的交叉计算;示例：使用示例数据集1计算每个BU下的平均团建费注意：目前报表类聚合函数暂不支持进行逻辑运算。如果要计算平均团建费用，需要将预算类型为团建费的数据费用进行计算，因此选择 费用字段 为 <度量字段> ，配置 预算类型="团建费" 为 [条件] ，由于每个BU下有多个部门，而我们不考虑部门情况，只需要计算每个BU下的平均团建费，因此需要将 部门字段 作为 [排除字段] 。公式如下：BU平均团建费=AVG(费用, 预算类型="团建费",部门):表格结果：BU部门部门总费用部门平均团建费xxpt协同700600xxptIT850600aliyun飞天1300200计算总平均团建费用如果要计算平均团建费用，需要将预算类型为团建费的数据费用进行计算，因此选择 费用字段 为 <度量字段> ，配置 预算类型="团建费" 为 [条件] 。由于计算总平均团建费用，需要将所有部门的团建费加起来计算，不需要考虑BU以及部门情况，因此需要将 部门字段及BU字段 均作为 [排除字段] 。公式如下：所有部门平均团建费=AVG(费用, 预算类型='团建费',部门,BU) :表格结果：BU部门部门总费用部门平均团建费所有平均团建费xxpt协同700600466.67xxptIT850600466.67aliyun飞天1300200466.67MAX​用法：MAX(<度量字段>,[条件],[排除字段])返回合乎[条件]下, 对<字段>求最大值的结果, [排除字段] 不参与求和的交叉计算;示例：使用示例数据集1部门最高团建费=MAX(费用, 预算类型='团建费') :注意：目前报表类聚合函数暂不支持进行逻辑运算。表格结果BU部门部门总费用部门最高团建费xxpt协同700500xxptIT850700aliyun飞天1300200BU最高团建费=MAX(费用, 预算类型="团建费", 部门) :表格结果BU部门部门总费用部门平均团建费BU最高团建费xxpt协同700600700xxptIT850600700aliyun飞天1300200200MIN​用法：MIN(<度量字段>,[条件],[排除字段])返回合乎[条件]下, 对<字段>求最小值的结果, [排除字段] 不参与求和的交叉计算;示例：使用示例数据集1部门最低团建费=MIN(费用, 预算类型="团建费") :注意：目前报表类聚合函数暂不支持进行逻辑运算。表格结果BU部门部门总费用部门最低团建费xxpt协同700500xxptIT850700aliyun飞天1300200BU最低团建费=MIN(费用, 预算类型="团建费", 部门) :表格结果BU部门部门总费用部门平均团建费BU最低团建费xxpt协同700600500xxptIT850600500aliyun飞天1300200200COUNTDISTINCT​用法：COUNTDISTINCT(<度量字段>,[条件],[排除字段])返回合乎[条件]下, 对<字段>进行去重计数的结果, [排除字段] 不参与求和的交叉计算;示例：使用示例数据集2BU 部门数量 = COUNTDISTINCT(部门, 费用>0,预算类型)注意：目前报表类聚合函数暂不支持进行逻辑运算。表格结果BU部门预算类型BU部门数量xxpt协同团建费1xxpt协同培训费1xxptIT团建费1xxptIT培训费1aliyun飞天1团建费1aliyun飞天1培训费1COUNT​用法：COUNT(<度量字段>,[条件],[排除字段])返回合乎[条件]下, 对<字段>进行计数的结果, [排除字段] 不参与求和的交叉计算;示例：使用示例数据集2部门预算条数 = COUNT(部门, 费用>0,预算类型)注意：目前报表类聚合函数暂不支持进行逻辑运算。表格结果BU部门预算类型BU部门数量xxpt协同团建费4xxpt协同培训费4xxptIT团建费2xxptIT培训费2aliyun飞天1团建费2aliyun飞天1培训费27. 时间处理类​时间处理类函数点击体验效果。NOW​用法：NOW()，获取当前时间，会精确到秒示例：略STRINGTODATE​用法：STRINGTODATE(<字段>,<格式>), 字符串转时间示例：STRINGTODATE("1989-09-27","yyyy-MM")返回值为"198909"以上两个函数的format格式目前统一为java 中格式化保持一致，支持格式类型如下：yyyy：年MM：月dd：日hh：1~12小时制(1-12)HH：24小时制(0-23)mm：分ss：秒DATEADD​用法：DATEADD(<时间字段>,<偏移量>,<时间粒度>)，在<时间字段>的基础上增加<时间粒度>的<偏移量>。时间粒度取值：YEAR：年MONTH：月DAY：日HOUR：时MINUTE：分SECOND：秒偏移量是需要增加或减少的具体数字，取值为正则表示增加，取值为负则表示减少。示例1：假设表单中日期组件的取值为"20200901"，那么DATEADD(日期组件,10,"DAY") = 20200911。示例2：假设表单中日期组件的取值为"20200901"，那么DATEADD(日期控件,-1,"DAY") = 20200831。日期展示格式默认为yyyyMMdd，如需需要修改日期的展示格式可以参考DATEFORMAT函数的示例。DATEDIFF​用法：DATEDIFF(<时间字段1>,<时间字段2>,<时间粒度>),返回的结果为时间段字段1减去时间段字段2在时间粒度上的差值。时间粒度可选值为：YEAR       年MONTH    月DAY        日HOUR      时MINUTE   分SECOND  秒示例：DATEDIFF(日期组件1,日期组件2,"DAY")，返回值为2个日期组件相差天数注意：参数仅支持日期组件，无法在公式输入固定日期值。假设表单中日期控件的日期值为“2020-02-14”，假设今天为“2020-02-16”，那么使用DATEDIFF(NOW(),填写日期,"DAY") = 2，DATEDIFF(填写日期,NOW(),"DAY") = -2DATEFORMAT​用法：DATEFORMAT(<日期字段>,<时间格式>),将日期格式化成字符串以上两个函数的format格式目前统一为java 中格式化保持一致，支持格式类型如下：yyyy：年MM：月dd：日hh：1~12小时制(1-12)HH：24小时制(0-23)mm：分ss：秒示例1:DATEFORMAT(<日期字段>,"yyyy-MM-dd")，若日期字段有个值为1989年8月4日，则返回值为1989-08-04，格式化时，也可以将"-"改为"/"等字符。示例2:DATEFORMAT(<日期字段>,"yyyy-MM-dd HH:mm:ss")，若日期字段有个值为2020年9月1日下午1点30分整，则返回值为2020-09-01 13:30:00，格式化时，也可以将连接符号"-"、“:”改为"/"、“年”、“月”、“日”等字符。FROMUNIXTIME​用法：将数字型的unix时间日期值unixtime转为日期值函数声明：datetime fromunixtime(bigint unixtime)参数说明：unixtime：Bigint类型，秒数，unix格式的日期时间值，若输入为string，double，decimal类型会隐式转换为bigint后参与运算。返回值：Datetime类型的日期值，unixtime为NULL时返回NULL。示例：fromunixtime(123456789) = 1973-11-30 05:33:09WEEK​用法：WEEK([日期], [起始日(可以不指定)]), 计算日期年份中的哪一周, 起始日不指定，默认一周的第一天是周一，起始日的值为：1-7 分别表示周一为第一天.... 周日为第一天示例：WEEK([日期],)返回值为"20202";字段的值为"2020-01-08"，起始日可以不指定，默认为空。QUARTER​用法：QUARTER([日期], [是否是财年(可以不指定)]), 计算日期年份中的哪一季度, 是否是财年：1表示按照财年统计(4月份), 0表示按照自然年示例：QUARTER([字段1], 0)返回值为"1";字段1的值为"2020-02-02"7. 数组类​ArrayToString​用法：ArrayToString(<数组字段>,[分隔符可选])，将数组转换为字符串示例：ArrayToString(<字段1>,<字段2>) 返回值为"产品部-技术部-业务部";字段1的值为"[产品部，技术部，业务部]"，字段2的值为"-"；若字段2的值为空，则返回"产品部,技术部,业务部",效果如下所示：StringToArray​用法：StringToArray(<字符串>,[分隔符可选])，将字符串解析为数组示例：StringToArray(<字段1>,<字段2>) 返回值为"[产品部,技术部,业务部]";字段1的值为"产品部-技术部-业务部"，字段2的值为"-"ArrayLength​用法：ArrayLength(<数组字段>)，返回数组长度示例：ArrayLength(<多选等数组字段>)返回值为"3";字段的值为"部门"，其选项为"产品部,技术部,业务部"ArrayCat​用法：ArrayCat(<数组字段1>,<数组字段2>,...)，返回多数组拼接格式示例：ArrayCat(<多选等数组字段1>,<多选等数组字段2>,...)返回值为"产品部,技术部,业务部,产品人员,技术人员,业务人员";字段1的值为"产品部,技术部,业务部"，字段2的值为"产品人员,技术人员,业务人员"8.统计类​ROUND​用法：ROUND(<字段>,<精度>), 四舍五入地对字段进行小数位数调整示例：ROUND(<字段1>,<精度>) 字段1的值为"12.33333"，精度为2；返回值为"12.33";统计类函数round，点击体验效果。MOD​用法：MOD(<字段>,<字段>), 取模(取余)运算，返回取模值（或余数）。说明：若要获得除法的商，可使用/ 四则运算符，比如 6/4 得到 商1余2。示例: MOD(<字段1>,<字段2>) 字段1的值为"6"，字段2的值为"4"，返回值为"2";统计类函数mod，点击体验效果。ParseDouble​用法：ParseDouble（<字段>），字符串或整数强转浮点数示例：ParseDouble（＜字段＞），如果字段的值是3或“3”，则结果3.0统计类函数parsedouble，点击体验效果。ParseInt​用法：Parselnt（＜字段>），字符串或浮点数强转整数示例：Parselnt（＜字段＞），如果字段的值是3.2或“3.2”，则结果3统计类函数parseint，点击体验效果。9. 常见问题​在报表中 COUNT() 怎么使用呢？​COUNT 是进行计数的函数，请查看以下视频的详细讲解为什么报表提醒：公式解析异常。详细内容:AST语法异常:SQL翻译时遇到未支持的数据库类型：11​目前报表公式字段只能使用当前文档已有的函数公式，若使用文档以外的函数公式就会进行报错，报错提示截图如下：CASEWHEN函数中判断组件为空不生效​当前公式内进行数据为空判断时，仅支持数据 IS NULL的写法，数据=""的写法不支持。 此文档对您是否有帮助？如需帮助，请访问 宜搭社区  进行讨论。如果您想通过视频学习，请关注 低代码宝典  进行学习。1. 使用场景​2. 报表公式视频讲解​3. 设置公式入口​4. 逻辑判断类​CASEWHEN​5. 字符串处理类​LEN​LEFT​RIGHT​MID​POS​UPPER​LOWER​VAL​LEFTTRIM​RIGHTTRIM​NUMBERTOSTRING​SPLITPART​CONCAT​REPLACE​STRINGTONUMBER​6. 聚合类​SUM​AVG​MAX​MIN​COUNTDISTINCT​COUNT​7. 时间处理类​NOW​STRINGTODATE​DATEADD​DATEDIFF​DATEFORMAT​FROMUNIXTIME​WEEK​QUARTER​7. 数组类​ArrayToString​StringToArray​ArrayLength​ArrayCat​8.统计类​ROUND​MOD​ParseDouble​ParseInt​9. 常见问题​在报表中 COUNT() 怎么使用呢？​为什么报表提醒：公式解析异常。详细内容:AST语法异常:SQL翻译时遇到未支持的数据库类型：11​CASEWHEN函数中判断组件为空不生效​钉钉扫码,关注宜搭服务窗微信扫码,关注宜搭公众号微信扫码,关注宜搭视频号快捷入口帮助中心更新日志版本价格开发者中心更多开发者社区关于宜搭向团队推荐宜搭联系我们售前咨询技术支持生态与伙伴宜搭阿里云官网Copyright © 2026钉钉（中国）信息技术有限公司和／或其关联公司浙ICP备18037475号-4


